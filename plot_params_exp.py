import matplotlib.pyplot as plt
import numpy as np
import pickle

sim = False
params = {'distance_params': {'zero_dist_prob_neg_exponent': np.array([0.12647467, 0.13069739, 0.13299723, 0.13402539, 0.13438583,
       0.13398806, 0.13373651, 0.13349616, 0.133643  , 0.13377113,              
       0.13382329, 0.13331461, 0.13346924, 0.1335121 , 0.13360461,              
       0.13312256, 0.13300212, 0.13308532, 0.13319074, 0.13327864,              
       0.13299082, 0.13318676, 0.13285037, 0.13231158, 0.13223606,              
       0.13198401, 0.13178399, 0.13144418, 0.13138585, 0.13170469,              
       0.13148925, 0.13179542, 0.13180117, 0.13218665, 0.13225388,              
       0.13258568, 0.13246797, 0.13213118, 0.13190626, 0.13157687]), 'lambda_speed': np.array([0.1       , 0.08878175, 0.08221098, 0.07951065, 0.0786044 ,
       0.07976388, 0.08084575, 0.08199646, 0.08131367, 0.0808153 ,              
       0.08009263, 0.08130629, 0.08084219, 0.08045435, 0.07983895,              
       0.08075183, 0.08194811, 0.08122353, 0.08076125, 0.08002065,              
       0.08142254, 0.08050642, 0.08128949, 0.0816716 , 0.08231711,              
       0.08253037, 0.0827606 , 0.08275678, 0.08338643, 0.08180134,              
       0.08217859, 0.08236855, 0.08188342, 0.08121958, 0.08103344,              
       0.0803914 , 0.08130038, 0.08173423, 0.0821147 , 0.08237913])}, 'deviation_beta': np.array([0.1       , 0.08092358, 0.0669153 , 0.05973189, 0.05155055,    
       0.05053078, 0.05000102, 0.05567248, 0.0560041 , 0.05607126,              
       0.05013621, 0.05592796, 0.05593496, 0.05614488, 0.05024485,              
       0.04992194, 0.05566986, 0.05573958, 0.05598133, 0.05005928,              
       0.05602814, 0.05007765, 0.04976902, 0.04932198, 0.04948861,              
       0.04909261, 0.04928343, 0.0489397 , 0.0553265 , 0.04950773,              
       0.04923668, 0.05353535, 0.05533361, 0.05428786, 0.05566435,              
       0.05007742, 0.04981148, 0.04957155, 0.04929595, 0.04955819]), 'gps_sd': np.array([7.        , 6.3825907 , 6.04282961, 5.84881813, 5.73590889,
       5.66401117, 5.64934122, 5.65569945, 5.67516552, 5.69273626,              
       5.65956429, 5.66320077, 5.6605009 , 5.65821173, 5.63140864,              
       5.62291219, 5.6385823 , 5.62568927, 5.65367725, 5.61298126,              
       5.66263109, 5.6220483 , 5.61406479, 5.61811794, 5.61169722,              
       5.59284126, 5.59946025, 5.61611878, 5.65537518, 5.62643844,              
       5.62410186, 5.68317898, 5.69740579, 5.67455591, 5.68857257,              
       5.68120703, 5.62070397, 5.60014144, 5.5989139, 5.61316532])}

params = {'distance_params': {'zero_dist_prob_neg_exponent': np.array([0.12647467, 0.13080951, 0.13248298, 0.13342224, 0.1338148 ,
       0.13404028, 0.13412131, 0.1342779 , 0.13435583, 0.13434215,
       0.13442292, 0.13443975, 0.13444228, 0.13450181, 0.1345477 ,
       0.13459571, 0.13452436, 0.13455399, 0.13446409, 0.13441802,
       0.13436105, 0.13433071, 0.1343302 , 0.13431669, 0.1342762 ,
       0.13422895, 0.13418434, 0.13415429, 0.13412625, 0.13408632,
       0.13402644, 0.13394094, 0.13389017, 0.13382768, 0.13378261,
       0.1337267 , 0.13369974, 0.1336741 , 0.13361132, 0.13356769,
       0.13352891, 0.13351107, 0.13348643, 0.13344572, 0.13341329,
       0.13339601, 0.13339796, 0.1333555 , 0.13334259, 0.13330252,
       0.13329451, 0.13326781, 0.13324619, 0.13323961, 0.13322903,
       0.13322713, 0.13323909, 0.13320424, 0.13318898, 0.13313939,
       0.13313357, 0.13310324, 0.13309924, 0.13307824, 0.13304261,
       0.13301312, 0.13300989, 0.13302508, 0.13305021, 0.13305177,
       0.13304339, 0.13302674, 0.13302443, 0.13302313, 0.13304043,
       0.13303282, 0.13302916, 0.13303362, 0.13302222, 0.13300071,
       0.13301404, 0.13301369, 0.13300774, 0.1329943 , 0.13298128,
       0.13297947, 0.13295355, 0.13295596, 0.13298135, 0.13299197,
       0.13299739, 0.13298346, 0.13297425, 0.13296824, 0.13297492,
       0.13297702, 0.13296523, 0.13296281, 0.13295965, 0.13295647,
       0.13293033, 0.13291462, 0.1328889 , 0.13288915, 0.13287994,
       0.1328544 , 0.13284164, 0.1328289 , 0.13282691, 0.13280686,
       0.13280422, 0.13281689, 0.13279359, 0.13279196, 0.13280115,
       0.13279571, 0.13279813, 0.13278632, 0.13276271, 0.13277245,
       0.13277168, 0.1327628 , 0.1327441 , 0.13273994, 0.13274156,
       0.13274375, 0.13273679, 0.13273262]), 'lambda_speed': np.array([0.1       , 0.0887157 , 0.08382818, 0.08149168, 0.08014287,
       0.07936351, 0.07887578, 0.07866533, 0.07849814, 0.07833382,
       0.07828724, 0.07822295, 0.07817721, 0.07819188, 0.0780993 ,
       0.07814211, 0.07816845, 0.07840756, 0.07840102, 0.07855236,
       0.07863794, 0.07871582, 0.078691  , 0.07871965, 0.07876591,
       0.07890515, 0.07892119, 0.07898456, 0.07906701, 0.07915488,
       0.07923154, 0.07936021, 0.07939118, 0.07943271, 0.07946929,
       0.07961577, 0.07966402, 0.07972441, 0.07976587, 0.07982628,
       0.07988344, 0.07996418, 0.08008923, 0.08010066, 0.08018464,
       0.08024556, 0.08024311, 0.08027016, 0.08029962, 0.08028534,
       0.08022079, 0.08021542, 0.08014712, 0.08016089, 0.08011302,
       0.08013859, 0.08009183, 0.08006089, 0.08005584, 0.08003943,
       0.08010487, 0.08013694, 0.08016451, 0.08011627, 0.0800771 ,
       0.08010301, 0.08012549, 0.08015346, 0.08012249, 0.08008999,
       0.08011878, 0.08007695, 0.08010448, 0.08011961, 0.08013546,
       0.0800804 , 0.08004669, 0.08003415, 0.08002038, 0.08004906,
       0.08004652, 0.0800847 , 0.080108  , 0.0800734 , 0.08005064,
       0.0800464 , 0.08007384, 0.08010628, 0.08010523, 0.08009255,
       0.08006835, 0.08009462, 0.08007302, 0.08009816, 0.08012107,
       0.08009631, 0.08007009, 0.08006056, 0.08005854, 0.08006261,
       0.08005541, 0.08006589, 0.08007048, 0.0801354 , 0.0801441 ,
       0.08017598, 0.08020847, 0.08022905, 0.08020801, 0.08022087,
       0.08023518, 0.08021656, 0.08018126, 0.08020742, 0.08019519,
       0.08017887, 0.08017857, 0.08017154, 0.08019374, 0.08018157,
       0.08019206, 0.08023116, 0.0802509 , 0.08026994, 0.08025417,
       0.0802449 , 0.08023422, 0.0802599 ])}, 'deviation_beta': np.array([0.1       , 0.08096656, 0.07025502, 0.06470061, 0.06141903,
       0.05947311, 0.0582848 , 0.05753086, 0.05705696, 0.05673321,
       0.05647489, 0.05628706, 0.05616185, 0.05611711, 0.05447211,
       0.05328134, 0.05238478, 0.05312728, 0.05228675, 0.05296678,
       0.05348238, 0.05387079, 0.05292315, 0.05214452, 0.05154442,
       0.05224109, 0.05161357, 0.05115654, 0.05079783, 0.05050258,
       0.0502253 , 0.0510688 , 0.05068272, 0.05039967, 0.04972243,
       0.05056852, 0.0502932 , 0.05007291, 0.04989426, 0.0498167 ,
       0.04959621, 0.04950492, 0.05028817, 0.05001869, 0.0507017 ,
       0.05127581, 0.05095848, 0.05152047, 0.05202465, 0.05243525,
       0.05195986, 0.05234372, 0.05184329, 0.05223172, 0.05177302,
       0.05216002, 0.05141828, 0.05106161, 0.05076434, 0.05055761,
       0.051053  , 0.05156833, 0.05195942, 0.05155425, 0.05122542,
       0.05167636, 0.05202754, 0.05241493, 0.05199152, 0.05159401,
       0.05196755, 0.05158968, 0.05196473, 0.0522912 , 0.05258034,
       0.05216503, 0.05178692, 0.0514426 , 0.05113993, 0.05154607,
       0.051254  , 0.05163489, 0.05197208, 0.0516181 , 0.05130863,
       0.05105291, 0.05143703, 0.05178922, 0.05146426, 0.05106234,
       0.05130339, 0.05168324, 0.0513908 , 0.05172875, 0.05204089,
       0.05171749, 0.05140052, 0.0511226 , 0.05090015, 0.05068553,
       0.05047979, 0.05030921, 0.05015795, 0.05062918, 0.05045046,
       0.05083257, 0.05119299, 0.05152926, 0.05125657, 0.05158342,
       0.05189841, 0.05157806, 0.05131315, 0.05163488, 0.05136311,
       0.0511104 , 0.05089893, 0.0506852 , 0.05107037, 0.05061498,
       0.05047143, 0.05085581, 0.05122302, 0.05154343, 0.05128753,
       0.05107678, 0.05088725, 0.0512361 ]), 'gps_sd': np.array([7.        , 6.35586038, 5.99002221, 5.82667639, 5.71806016,
       5.69359831, 5.66807513, 5.66987343, 5.68351162, 5.67220325,
       5.67335026, 5.67361658, 5.64423348, 5.64676409, 5.6155078 ,
       5.59748635, 5.59332834, 5.62365268, 5.6305887 , 5.6429993 ,
       5.64945893, 5.66594872, 5.62236613, 5.61178715, 5.59235387,
       5.61514262, 5.60286618, 5.62023885, 5.61829269, 5.59435515,
       5.56554725, 5.62926766, 5.60266104, 5.61442377, 5.61299667,
       5.59932165, 5.59977527, 5.58242554, 5.60599763, 5.61627982,
       5.61525944, 5.6233634 , 5.62811724, 5.59316929, 5.64276369,
       5.65223828, 5.63041724, 5.64287284, 5.66219073, 5.64133187,
       5.60755256, 5.60834615, 5.60032279, 5.65094159, 5.62474763,
       5.65692301, 5.61249705, 5.58312972, 5.5777091 , 5.58995321,
       5.625202  , 5.65888486, 5.6584318 , 5.63265488, 5.60965911,
       5.62937971, 5.63369668, 5.65888887, 5.61832274, 5.60215538,
       5.64289787, 5.61084807, 5.6545458 , 5.64533689, 5.64011142,
       5.60833735, 5.59696752, 5.60125369, 5.60498284, 5.63555977,
       5.62484836, 5.65343285, 5.64730137, 5.59688627, 5.60596718,
       5.58171781, 5.62003283, 5.65860807, 5.63317   , 5.61212634,
       5.650767  , 5.63653496, 5.62024975, 5.6404854 , 5.64430017,
       5.60631459, 5.58712037, 5.60155296, 5.58664357, 5.60412363,
       5.57873323, 5.58273671, 5.61286325, 5.64047934, 5.60770647,
       5.61958957, 5.63789922, 5.64767024, 5.63849196, 5.65420921,
       5.66557266, 5.61758651, 5.60203674, 5.62278994, 5.59884825,
       5.59863866, 5.6047541 , 5.58819296, 5.59685913, 5.59564458,
       5.61544634, 5.65364329, 5.64879017, 5.63524806, 5.61983586,
       5.61842316, 5.60333201, 5.62951668])}

params = {'distance_params': {'zero_dist_prob_neg_exponent': np.array([0.12647467, 0.1302187 , 0.1316902 , 0.13250631, 0.13288179,
       0.1331786 , 0.13331473, 0.13331742, 0.13332921, 0.13328883,              
       0.13325121, 0.13323987, 0.13320658, 0.13325906, 0.13318675,              
       0.13320123, 0.13317528, 0.1331499 , 0.1330896 , 0.13309751,              
       0.1330779 , 0.13304772, 0.13306908, 0.13303479, 0.13299688,              
       0.13296513, 0.13295103, 0.13294793, 0.13290493, 0.13290643,              
       0.13288211, 0.132889  , 0.1328991 , 0.13288106, 0.13289663,              
       0.13290574, 0.13291126, 0.13292333, 0.13291589, 0.13291836,              
       0.13289668, 0.13290776, 0.13290675, 0.13293656, 0.13292279,              
       0.13291154, 0.1328782 , 0.13289328, 0.13289355, 0.13288054,              
       0.13283396, 0.13284915]), 'lambda_speed': np.array([0.1       , 0.08722124, 0.08097775, 0.07728032, 0.07476691,
       0.07300366, 0.07176919, 0.0707925 , 0.07008513, 0.06956312,              
       0.06913552, 0.06880848, 0.06852505, 0.0683537 , 0.06809766,              
       0.06793688, 0.06776029, 0.06760673, 0.06743353, 0.06731218,              
       0.06721972, 0.06711032, 0.06705029, 0.06695093, 0.06684553,              
       0.06675722, 0.06668098, 0.06661697, 0.06653446, 0.06648586,              
       0.06641826, 0.06637999, 0.06634831, 0.06628735, 0.06626487,              
       0.06623667, 0.06620932, 0.06618261, 0.06614699, 0.06611694,              
       0.06606937, 0.06605543, 0.06600094, 0.065901  , 0.06588582,              
       0.06587563, 0.06584247, 0.06585332, 0.06584364, 0.06581914,              
       0.06576597, 0.06574831])}, 'deviation_beta': np.array([0.1       , 0.08230195, 0.07292084, 0.06741117, 0.06390116,
       0.06058987, 0.0585769 , 0.05709128, 0.05576006, 0.05534696,              
       0.05496393, 0.05470529, 0.05460087, 0.05451454, 0.05451837,              
       0.05450726, 0.05446643, 0.05447642, 0.05447656, 0.05420764,              
       0.05433599, 0.05438318, 0.05442028, 0.05448203, 0.05454398,              
       0.05458818, 0.05459578, 0.05458707, 0.05461788, 0.0546342 ,              
       0.05464525, 0.05466238, 0.05471461, 0.05466916, 0.05468032,              
       0.05470948, 0.05470847, 0.05475566, 0.0547894 , 0.05479351,              
       0.05479736, 0.05480912, 0.05441397, 0.05429836, 0.05433888,              
       0.05441888, 0.05447871, 0.05452983, 0.05460846, 0.05463456,              
       0.05463512, 0.05432444]), 'gps_sd': np.array([7.        , 6.23939837, 5.79668224, 5.60451024, 5.49703642,
       5.37060212, 5.2901081 , 5.25522071, 5.25652103, 5.21176793,              
       5.19410699, 5.20472661, 5.21752874, 5.22623689, 5.22160032,              
       5.21514485, 5.19453113, 5.23486423, 5.21303912, 5.17749057,              
       5.20521628, 5.18294557, 5.18296129, 5.20555367, 5.2196821 ,              
       5.22535782, 5.19740003, 5.18520502, 5.23292222, 5.22139257,              
       5.22914131, 5.21871785, 5.23380972, 5.24726502, 5.22783789,              
       5.23966028, 5.23204297, 5.20384672, 5.18197805, 5.15987618,              
       5.16445753, 5.17624163, 5.17489822, 5.23265403, 5.20422805,              
       5.2183021 , 5.23583517, 5.18678852, 5.21030208, 5.20357274,              
       5.22303915, 5.19678604])}

params = {'distance_params': {'zero_dist_prob_neg_exponent': np.array([0.12647467, 0.13023755, 0.13172979, 0.13258189, 0.13312406,
       0.13337847, 0.13341997, 0.13341474, 0.13348377]), 'lambda_speed': np.array([0.1       , 0.08721802, 0.08099941, 0.07729709, 0.07480998,
       0.07308073, 0.07181947, 0.07089125, 0.07023852])}, 'deviation_beta': np.array([0.1       , 0.08251161, 0.07335242, 0.06792901, 0.06314376,
       0.06000966, 0.05815226, 0.05683913, 0.05561355]), 'gps_sd': np.array([7.        , 6.19932113, 5.76096175, 5.49904979, 5.30208431,
       5.20071347, 5.18218072, 5.1301996 , 5.12642244])}  

# Simulated data
# sim = True
# params = pickle.load(open('/Users/samddd/Main/bayesian-map-matching/simulations/cambridge/tuned_sim_params.pickle', 'rb'))
# params = pickle.load(open('/Users/samddd/Main/bayesian-map-matching/simulations/cambridge/tuned_sim_params._0.1_0.05_0.05_3_prcap500_final.pickle', 'rb'))
#
# params = {'distance_params': {'zero_dist_prob_neg_exponent': np.array([0.12647467, 0.13352728, 0.13563493, 0.1363461 , 0.13680604,
#        0.13706412, 0.13734336, 0.1376507 , 0.13790093, 0.13822715,
#        0.13847304, 0.13865541, 0.13883829, 0.13902936, 0.13922137,
#        0.13937613, 0.13959797, 0.13978853, 0.13987911, 0.14002672,
#        0.14010243, 0.14021578, 0.1403004 , 0.14036982, 0.14044573,
#        0.14054459, 0.1405827 , 0.14065552, 0.1407209 , 0.14081909,
#        0.14087992, 0.14094747, 0.14100441, 0.1410549 , 0.14112139,
#        0.14115597, 0.14119469, 0.14129322, 0.14129424, 0.14132965,
#        0.14135054, 0.14140988, 0.14148727, 0.14154381, 0.14159415,
#        0.14165561, 0.14171985]), 'lambda_speed': np.array([0.1       , 0.0739436 , 0.06336797, 0.05815913, 0.05552143,
#        0.05393546, 0.05291699, 0.05226735, 0.05174492, 0.0514462 ,
#        0.0511343 , 0.05082605, 0.05057932, 0.0503856 , 0.05024768,
#        0.05009778, 0.05004654, 0.04999487, 0.04984553, 0.04977708,
#        0.04964277, 0.04957647, 0.04948316, 0.04937956, 0.04929793,
#        0.0492627 , 0.0491617 , 0.04911753, 0.04907581, 0.04906599,
#        0.04902282, 0.04899825, 0.04896457, 0.04892781, 0.04891075,
#        0.04886173, 0.04881766, 0.04885596, 0.04877713, 0.04874515,
#        0.04869682, 0.04869665, 0.04872931, 0.04873236, 0.04873196,
#        0.04874611, 0.04876179])}, 'deviation_beta': np.array([0.1       , 0.07178123, 0.05778047, 0.05125079, 0.04863266,
#        0.04785774, 0.04757534, 0.04758136, 0.04756025, 0.04767784,
#        0.04777918, 0.04783405, 0.0479456 , 0.04795298, 0.0480369 ,
#        0.04807616, 0.04808304, 0.04813162, 0.04821071, 0.04824485,
#        0.04828124, 0.04830583, 0.04832075, 0.04833678, 0.04836524,
#        0.04836811, 0.04838825, 0.04843482, 0.04846269, 0.04844384,
#        0.04843336, 0.0484814 , 0.04853264, 0.04856322, 0.04859   ,
#        0.04860479, 0.04860215, 0.04862118, 0.04863223, 0.04867907,
#        0.04866147, 0.04866756, 0.04866849, 0.04868308, 0.04870459,
#        0.04873472, 0.04872889]), 'gps_sd': np.array([7.        , 5.24028681, 4.17109222, 3.56563876, 3.26107578,
#        3.11322238, 3.03905867, 3.02527181, 3.00064226, 2.99670348,
#        2.99571855, 2.99223675, 2.99335395, 2.99659232, 3.00336285,
#        2.99956131, 2.99161086, 2.990963  , 2.99212789, 2.98595214,
#        3.00086809, 2.99347553, 2.99137939, 2.99161227, 3.00269222,
#        3.00098867, 3.00717933, 3.01076062, 2.98899627, 2.99975137,
#        2.98912355, 3.00038691, 2.99231244, 3.00028342, 2.99401049,
#        3.00070735, 2.99278517, 2.99431949, 2.99315177, 3.00771665,
#        3.00088354, 2.99678013, 2.98577468, 2.99245836, 2.99419961,
#        2.99700142, 2.98893916])}
#
# params = {'distance_params': {'zero_dist_prob_neg_exponent': np.array([0.12647467, 0.13524542, 0.13960614, 0.14233387, 0.14435581,
#        0.14595082, 0.14725589, 0.14837162, 0.1493802 , 0.15018635,
#        0.15098842, 0.15164052, 0.15223761, 0.15277727, 0.15330588,
#        0.15378252, 0.15426708, 0.15473765, 0.15519053, 0.15559587,
#        0.15597226, 0.15630437, 0.15665105, 0.15696298, 0.15728284,
#        0.15757415, 0.1578558 , 0.15815472, 0.15840456, 0.15867426,
#        0.15892224, 0.15916909, 0.15939302, 0.15960744, 0.15980027,
#        0.16003284, 0.16021199, 0.16041607, 0.16059824, 0.16075523,
#        0.16093397, 0.16110272, 0.1612654 , 0.16143639, 0.16158281,
#        0.16173226, 0.16188491, 0.16203103, 0.16217829, 0.16230919,
#        0.16244031, 0.16257397, 0.16269781, 0.16280895, 0.16293026,
#        0.16304692, 0.16315471, 0.16325948, 0.16335735, 0.16345161,
#        0.16356084, 0.16365432, 0.16377259, 0.16389663, 0.16399318,
#        0.16409893, 0.16417753, 0.16426589, 0.16433605, 0.16443005,
#        0.16450566, 0.16460609, 0.16467493, 0.16475147, 0.16484609,
#        0.1649297 , 0.16502207, 0.16511403, 0.16519214, 0.16526772,
#        0.1653309 , 0.16540045, 0.16547575, 0.16553192, 0.16558624,
#        0.1656505 , 0.16571044, 0.16576667, 0.16583198, 0.16588643,
#        0.16595256, 0.16601234, 0.16608624, 0.16614585, 0.16620495,
#        0.16627436, 0.16632443, 0.16636936, 0.1664203 , 0.1664604 ,
#        0.16651792, 0.16656471, 0.16662054, 0.1666694 , 0.16672221,
#        0.16677055, 0.16682268, 0.16687737, 0.16690924, 0.16694491,
#        0.16699916, 0.16704999, 0.16709044, 0.16712849, 0.16715094,
#        0.16720814, 0.1672592 , 0.16731081, 0.16735632, 0.16740133,
#        0.16743097, 0.16747883, 0.16751035, 0.16754996, 0.16758849,
#        0.16762338, 0.16765199, 0.16767134, 0.16771604, 0.16775328,
#        0.16778864, 0.1678209 , 0.16785157, 0.16787378, 0.16790078,
#        0.16793631, 0.16796469, 0.16799046, 0.168021  , 0.16805099,
#        0.16808647, 0.16811903, 0.16815207, 0.16818998, 0.16821525,
#        0.16824549, 0.16827644, 0.16830652, 0.16831922, 0.16834321,
#        0.1683686 , 0.16839417, 0.16841875, 0.16844851, 0.16846179,
#        0.1684863 , 0.16849742, 0.16852184]), 'lambda_speed': np.array([0.1       , 0.0855002 , 0.07798973, 0.07322818, 0.07005225,
#        0.06784238, 0.06623602, 0.06504119, 0.06415531, 0.06337071,
#        0.06280638, 0.06226113, 0.06181058, 0.06140325, 0.06107476,
#        0.06076152, 0.06051768, 0.06030746, 0.06012331, 0.05992743,
#        0.05974212, 0.0595449 , 0.05939464, 0.05922688, 0.05909337,
#        0.05895381, 0.05882663, 0.05872939, 0.0586063 , 0.05850898,
#        0.05841167, 0.05832973, 0.05822952, 0.05813047, 0.05803015,
#        0.05797515, 0.05787204, 0.05780481, 0.05772513, 0.05764137,
#        0.05757868, 0.05751026, 0.057444  , 0.05738448, 0.05731218,
#        0.05724946, 0.05719579, 0.05714373, 0.0570998 , 0.05703811,
#        0.05699195, 0.05694841, 0.05689856, 0.05683515, 0.05678536,
#        0.05673518, 0.05668583, 0.05663549, 0.05657946, 0.05652793,
#        0.05649872, 0.05645632, 0.05644494, 0.05644326, 0.05640672,
#        0.05638663, 0.05633413, 0.05629727, 0.05624429, 0.05621594,
#        0.05617146, 0.05616168, 0.05611531, 0.0560812 , 0.05606803,
#        0.0560453 , 0.05603636, 0.05602261, 0.05599567, 0.0559712 ,
#        0.05593234, 0.05590769, 0.05588889, 0.05585357, 0.05581787,
#        0.05579093, 0.05575898, 0.05573058, 0.05571295, 0.05568263,
#        0.05567213, 0.0556542 , 0.0556505 , 0.05562793, 0.05560918,
#        0.05560869, 0.05558231, 0.05555242, 0.05553072, 0.05549813,
#        0.05548395, 0.05546193, 0.05545032, 0.05542941, 0.05541497,
#        0.05539881, 0.0553828 , 0.05537719, 0.05534309, 0.05531905,
#        0.05531264, 0.05530747, 0.05529047, 0.05527154, 0.05523812,
#        0.05524328, 0.05524184, 0.05524241, 0.05524029, 0.05523321,
#        0.05521033, 0.05520805, 0.05518557, 0.05517445, 0.05516168,
#        0.05514069, 0.05511624, 0.05508643, 0.0550886 , 0.05507946,
#        0.05507054, 0.05505601, 0.0550389 , 0.05501664, 0.05499832,
#        0.05499367, 0.05498032, 0.05496232, 0.05494796, 0.05493712,
#        0.05493723, 0.05492765, 0.05492337, 0.05492409, 0.05490623,
#        0.0548977 , 0.05488942, 0.05488417, 0.05485845, 0.05484905,
#        0.054839  , 0.05483059, 0.05481601, 0.05481067, 0.05478685,
#        0.05478024, 0.05476151, 0.05475713])}, 'deviation_beta': np.array([0.1       , 0.08306431, 0.07284846, 0.06621753, 0.06163391,
#        0.0585685 , 0.05648671, 0.05513517, 0.05420342, 0.05358413,
#        0.05320786, 0.05293712, 0.05268495, 0.05262043, 0.05264641,
#        0.05263725, 0.05265449, 0.05270636, 0.05271796, 0.05275576,
#        0.05276311, 0.05280964, 0.05286552, 0.05291268, 0.05294764,
#        0.05300427, 0.05310257, 0.05316816, 0.05320246, 0.05325547,
#        0.05331243, 0.05333327, 0.05341183, 0.05343872, 0.0535206 ,
#        0.05356945, 0.05358691, 0.05362162, 0.05366086, 0.05371409,
#        0.05377402, 0.05383866, 0.05386397, 0.05389223, 0.05392105,
#        0.05395773, 0.05397795, 0.05402255, 0.05404987, 0.05408498,
#        0.05411228, 0.05414545, 0.05416632, 0.05418512, 0.05420699,
#        0.05421223, 0.05421677, 0.05426023, 0.05427456, 0.05429356,
#        0.05432504, 0.05435618, 0.05438425, 0.05440081, 0.0544304 ,
#        0.05445004, 0.05446216, 0.05446816, 0.05449474, 0.05451151,
#        0.0545344 , 0.05452964, 0.05456592, 0.0546024 , 0.05462473,
#        0.05464019, 0.05467949, 0.05467934, 0.05469451, 0.05469567,
#        0.05471384, 0.05469899, 0.05471436, 0.05473528, 0.05475738,
#        0.05475512, 0.05478124, 0.05479291, 0.0548051 , 0.05483091,
#        0.05484284, 0.0548615 , 0.05488385, 0.0548989 , 0.05489882,
#        0.05487993, 0.05489973, 0.05492461, 0.05493711, 0.05493643,
#        0.05495703, 0.05497404, 0.05498152, 0.0550124 , 0.05502685,
#        0.05503339, 0.05502585, 0.05503469, 0.05504058, 0.05504814,
#        0.05507767, 0.05508779, 0.05506268, 0.05506382, 0.05508559,
#        0.05510084, 0.05511361, 0.0551219 , 0.05512721, 0.05513749,
#        0.05515594, 0.05514136, 0.05514035, 0.05516332, 0.05516375,
#        0.05515102, 0.05516458, 0.05516159, 0.0551873 , 0.055189  ,
#        0.05520166, 0.05521421, 0.05522563, 0.05522791, 0.05523411,
#        0.05524153, 0.05524243, 0.05525331, 0.05525627, 0.05527764,
#        0.05529985, 0.05530774, 0.05531493, 0.05531499, 0.05530519,
#        0.05530379, 0.05530657, 0.05532475, 0.05532647, 0.05533189,
#        0.05534194, 0.05534641, 0.05534804, 0.05534954, 0.05535296,
#        0.05535294, 0.05531811, 0.05532692]), 'gps_sd': np.array([7.        , 5.2758021 , 4.18179956, 3.52711412, 3.20261749,
#        3.03057324, 2.94020094, 2.89065577, 2.86866916, 2.8670936 ,
#        2.86576341, 2.86811768, 2.85797727, 2.86938884, 2.86921102,
#        2.87659035, 2.87600641, 2.86279624, 2.86632855, 2.87102384,
#        2.86870119, 2.86487542, 2.85833425, 2.85932108, 2.86651693,
#        2.85990595, 2.86153511, 2.86087872, 2.85683807, 2.86561696,
#        2.86808243, 2.86986912, 2.862378  , 2.85654522, 2.85282676,
#        2.84776869, 2.85653615, 2.85935504, 2.85687855, 2.85425821,
#        2.86520343, 2.86049999, 2.86284306, 2.85397786, 2.86280258,
#        2.8566307 , 2.86164466, 2.85689441, 2.86498509, 2.8600196 ,
#        2.8626873 , 2.85391382, 2.86525454, 2.86824061, 2.86317216,
#        2.85257489, 2.86029269, 2.85556018, 2.85225851, 2.85114728,
#        2.85221333, 2.86320048, 2.86780375, 2.86589389, 2.86304201,
#        2.8581383 , 2.86584707, 2.86527319, 2.85575785, 2.84867805,
#        2.85617183, 2.87969797, 2.86544239, 2.86863036, 2.86986824,
#        2.85862436, 2.85764514, 2.85227587, 2.85450196, 2.85657946,
#        2.8558264 , 2.86411278, 2.85582892, 2.86010414, 2.85055716,
#        2.86009807, 2.85378169, 2.86665601, 2.85482426, 2.859844  ,
#        2.86165063, 2.86350393, 2.86668988, 2.85863427, 2.86574503,
#        2.85737869, 2.84594131, 2.85557374, 2.86703792, 2.84694517,
#        2.84835258, 2.85791796, 2.86145436, 2.86341908, 2.87611711,
#        2.86899104, 2.85748787, 2.84450605, 2.84727595, 2.85605279,
#        2.86238967, 2.84697097, 2.85606427, 2.85734905, 2.85892602,
#        2.86400403, 2.86199624, 2.85456924, 2.86441656, 2.85591704,
#        2.8569586 , 2.84328098, 2.85255498, 2.85014282, 2.85284102,
#        2.87333219, 2.86549965, 2.86248054, 2.86158887, 2.85577465,
#        2.85645409, 2.85562411, 2.85261678, 2.86775429, 2.86400108,
#        2.86936305, 2.86734334, 2.87374734, 2.87187497, 2.87207837,
#        2.86203853, 2.85738289, 2.85237194, 2.85162037, 2.84048052,
#        2.84958776, 2.8542198 , 2.84545913, 2.86148713, 2.86017634,
#        2.85857357, 2.85270813, 2.85919   , 2.86026999, 2.86344924,
#        2.8550618 , 2.85681268, 2.86020236])}

n_iter = len(params['gps_sd'])

fig, axes = plt.subplots(4, 1, sharex=True, figsize=(7, 10))

axes[0].plot(np.arange(n_iter), np.exp(-15 * params['distance_params']['zero_dist_prob_neg_exponent']))
axes[1].plot(np.arange(n_iter), params['distance_params']['lambda_speed'])
axes[2].plot(np.arange(n_iter), params['deviation_beta'])
axes[3].plot(np.arange(n_iter), params['gps_sd'])

axes[0].set_ylabel(r'$p^0$')
axes[1].set_ylabel(r'$\lambda$')
axes[2].set_ylabel(r'$\beta$')
axes[3].set_ylabel(r'$\sigma_{GPS}$')

if sim:
       line_colour = 'purple'
       axes[0].hlines(0.10, 0, n_iter, colors=line_colour)
       axes[1].hlines(1/15, 0, n_iter,  colors=line_colour)
       axes[2].hlines(0.05, 0, n_iter, colors=line_colour)
       axes[3].hlines(3.0, 0, n_iter, colors=line_colour)

plt.tight_layout()
plt.show()
